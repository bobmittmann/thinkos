/*
 * WARNING: do not edit, this file was automatically generated.
*/
/* Sine and Cosine functions using Lookup and interpolate method.
  - size of the lookup tables: N = 64
 */

#include <fixpt.h>

/* Enable polynomial interpolation */
#ifndef FIXPT_SINCOS_INTRPL_POLY
#define FIXPT_SINCOS_INTRPL_POLY 0
#endif

/* Enable 2nd order polynomial interpolation */
#ifndef FIXPT_SINCOS_INTRPL_POLY2
#define FIXPT_SINCOS_INTRPL_POLY2 0
#endif

/* Enable trigonometric interpolation */
#ifndef FIXPT_SINCOS_INTRPL_TRIG
#define FIXPT_SINCOS_INTRPL_TRIG 1
#endif

#define LOG2_N 6
#define MASK_N 63
#define Q31_ONE INT32_MAX

const int32_t qsintab[] = {
	0x00000000, /*   0 ->  0.0000000000 */
	0x0647d97c, /*   1 ->  0.0490676761 */
	0x0c8bd35e, /*   2 ->  0.0980171412 */
	0x12c8106e, /*   3 ->  0.1467304677 */
	0x18f8b83c, /*   4 ->  0.1950903237 */
	0x1f19f97b, /*   5 ->  0.2429801822 */
	0x25280c5d, /*   6 ->  0.2902846634 */
	0x2b1f34eb, /*   7 ->  0.3368898630 */
	0x30fbc54d, /*   8 ->  0.3826834261 */
	0x36ba2013, /*   9 ->  0.4275550842 */
	0x3c56ba70, /*  10 ->  0.4713967443 */
	0x41ce1e64, /*  11 ->  0.5141027570 */
	0x471cece6, /*  12 ->  0.5555702448 */
	0x4c3fdff3, /*  13 ->  0.5956993103 */
	0x5133cc94, /*  14 ->  0.6343932748 */
	0x55f5a4d2, /*  15 ->  0.6715589762 */
	0x5a827999, /*  16 ->  0.7071067691 */
	0x5ed77c89, /*  17 ->  0.7409511209 */
	0x62f201ac, /*  18 ->  0.7730104327 */
	0x66cf811f, /*  19 ->  0.8032075167 */
	0x6a6d98a3, /*  20 ->  0.8314695954 */
	0x6dca0d14, /*  21 ->  0.8577286005 */
	0x70e2cbc5, /*  22 ->  0.8819212914 */
	0x73b5ebd0, /*  23 ->  0.9039893150 */
	0x7641af3c, /*  24 ->  0.9238795042 */
	0x78848413, /*  25 ->  0.9415440559 */
	0x7a7d055a, /*  26 ->  0.9569403529 */
	0x7c29fbed, /*  27 ->  0.9700312614 */
	0x7d8a5f3f, /*  28 ->  0.9807852507 */
	0x7e9d55fb, /*  29 ->  0.9891765118 */
	0x7f62368e, /*  30 ->  0.9951847196 */
	0x7fd8878d, /*  31 ->  0.9987954497 */
	0x7fffffff, /*  32 ->  1.0000000000 */
	0x7fd8878d, /*  33 ->  0.9987954497 */
	0x7f62368e, /*  34 ->  0.9951847196 */
	0x7e9d55fb, /*  35 ->  0.9891765118 */
	0x7d8a5f3f, /*  36 ->  0.9807852507 */
	0x7c29fbed, /*  37 ->  0.9700312614 */
	0x7a7d055a, /*  38 ->  0.9569403529 */
	0x78848413, /*  39 ->  0.9415440559 */
	0x7641af3c, /*  40 ->  0.9238795042 */
	0x73b5ebd0, /*  41 ->  0.9039893150 */
	0x70e2cbc5, /*  42 ->  0.8819212914 */
	0x6dca0d14, /*  43 ->  0.8577286005 */
	0x6a6d98a3, /*  44 ->  0.8314695954 */
	0x66cf811f, /*  45 ->  0.8032075167 */
	0x62f201ac, /*  46 ->  0.7730104327 */
	0x5ed77c89, /*  47 ->  0.7409511209 */
	0x5a827999, /*  48 ->  0.7071067691 */
	0x55f5a4d2, /*  49 ->  0.6715589762 */
	0x5133cc94, /*  50 ->  0.6343932748 */
	0x4c3fdff3, /*  51 ->  0.5956993103 */
	0x471cece6, /*  52 ->  0.5555702448 */
	0x41ce1e64, /*  53 ->  0.5141027570 */
	0x3c56ba70, /*  54 ->  0.4713967443 */
	0x36ba2013, /*  55 ->  0.4275550842 */
	0x30fbc54d, /*  56 ->  0.3826834261 */
	0x2b1f34eb, /*  57 ->  0.3368898630 */
	0x25280c5d, /*  58 ->  0.2902846634 */
	0x1f19f97b, /*  59 ->  0.2429801822 */
	0x18f8b83c, /*  60 ->  0.1950903237 */
	0x12c8106e, /*  61 ->  0.1467304677 */
	0x0c8bd35e, /*  62 ->  0.0980171412 */
	0x0647d97c, /*  63 ->  0.0490676761 */
};

#define DX ((int32_t)(1 << (31 - LOG2_N)))

const int32_t fsintab[] = {
	0x00000000, /*   0 ->  0.0000000000 */
	0x001921fb, /*   1 ->  0.0007669902 */
	0x003243f5, /*   2 ->  0.0015339800 */
	0x004b65ee, /*   3 ->  0.0023009693 */
	0x006487e3, /*   4 ->  0.0030679568 */
	0x007da9d4, /*   5 ->  0.0038349424 */
	0x0096cbc1, /*   6 ->  0.0046019261 */
	0x00afeda8, /*   7 ->  0.0053689070 */
	0x00c90f88, /*   8 ->  0.0061358847 */
	0x00e23160, /*   9 ->  0.0069028586 */
	0x00fb5330, /*  10 ->  0.0076698288 */
	0x011474f6, /*  11 ->  0.0084367944 */
	0x012d96b1, /*  12 ->  0.0092037544 */
	0x0146b860, /*  13 ->  0.0099707097 */
	0x015fda03, /*  14 ->  0.0107376594 */
	0x0178fb99, /*  15 ->  0.0115046017 */
	0x01921d20, /*  16 ->  0.0122715384 */
	0x01ab3e97, /*  17 ->  0.0130384676 */
	0x01c45ffe, /*  18 ->  0.0138053885 */
	0x01dd8154, /*  19 ->  0.0145723019 */
	0x01f6a297, /*  20 ->  0.0153392069 */
	0x020fc3c6, /*  21 ->  0.0161061026 */
	0x0228e4e2, /*  22 ->  0.0168729872 */
	0x024205e8, /*  23 ->  0.0176398642 */
	0x025b26d7, /*  24 ->  0.0184067301 */
	0x027447b0, /*  25 ->  0.0191735849 */
	0x028d6870, /*  26 ->  0.0199404284 */
	0x02a68917, /*  27 ->  0.0207072608 */
	0x02bfa9a4, /*  28 ->  0.0214740802 */
	0x02d8ca16, /*  29 ->  0.0222408883 */
	0x02f1ea6c, /*  30 ->  0.0230076816 */
	0x030b0aa4, /*  31 ->  0.0237744618 */
	0x03242abf, /*  32 ->  0.0245412290 */
	0x033d4abb, /*  33 ->  0.0253079813 */
	0x03566a96, /*  34 ->  0.0260747187 */
	0x036f8a51, /*  35 ->  0.0268414393 */
	0x0388a9ea, /*  36 ->  0.0276081450 */
	0x03a1c95f, /*  37 ->  0.0283748358 */
	0x03bae8b2, /*  38 ->  0.0291415080 */
	0x03d407df, /*  39 ->  0.0299081653 */
	0x03ed26e6, /*  40 ->  0.0306748040 */
	0x040645c7, /*  41 ->  0.0314414240 */
	0x041f6480, /*  42 ->  0.0322080255 */
	0x04388310, /*  43 ->  0.0329746082 */
	0x0451a177, /*  44 ->  0.0337411724 */
	0x046abfb3, /*  45 ->  0.0345077142 */
	0x0483ddc3, /*  46 ->  0.0352742374 */
	0x049cfba7, /*  47 ->  0.0360407420 */
	0x04b6195d, /*  48 ->  0.0368072242 */
	0x04cf36e5, /*  49 ->  0.0375736840 */
	0x04e8543e, /*  50 ->  0.0383401215 */
	0x05017165, /*  51 ->  0.0391065367 */
	0x051a8e5c, /*  52 ->  0.0398729295 */
	0x0533ab20, /*  53 ->  0.0406392962 */
	0x054cc7b1, /*  54 ->  0.0414056405 */
	0x0565e40d, /*  55 ->  0.0421719626 */
	0x057f0035, /*  56 ->  0.0429382585 */
	0x05981c26, /*  57 ->  0.0437045284 */
	0x05b137df, /*  58 ->  0.0444707721 */
	0x05ca5361, /*  59 ->  0.0452369899 */
	0x05e36ea9, /*  60 ->  0.0460031815 */
	0x05fc89b8, /*  61 ->  0.0467693470 */
	0x0615a48b, /*  62 ->  0.0475354828 */
	0x062ebf22, /*  63 ->  0.0483015925 */
	0x0647d97c, /*  64 ->  0.0490676761 */
};

const int32_t fcostab[] = {
	0x7fffffff, /*   0 ->  1.0000000000 */
	0x7ffffd87, /*   1 ->  0.9999997020 */
	0x7ffff620, /*   2 ->  0.9999988079 */
	0x7fffe9ca, /*   3 ->  0.9999973774 */
	0x7fffd885, /*   4 ->  0.9999952912 */
	0x7fffc250, /*   5 ->  0.9999926686 */
	0x7fffa72b, /*   6 ->  0.9999893904 */
	0x7fff8718, /*   7 ->  0.9999855757 */
	0x7fff6215, /*   8 ->  0.9999811649 */
	0x7fff3823, /*   9 ->  0.9999761581 */
	0x7fff0942, /*  10 ->  0.9999706149 */
	0x7ffed571, /*  11 ->  0.9999644160 */
	0x7ffe9cb1, /*  12 ->  0.9999576211 */
	0x7ffe5f02, /*  13 ->  0.9999502897 */
	0x7ffe1c64, /*  14 ->  0.9999423623 */
	0x7ffdd4d6, /*  15 ->  0.9999338388 */
	0x7ffd8859, /*  16 ->  0.9999247193 */
	0x7ffd36ed, /*  17 ->  0.9999150038 */
	0x7ffce092, /*  18 ->  0.9999046922 */
	0x7ffc8548, /*  19 ->  0.9998938441 */
	0x7ffc250e, /*  20 ->  0.9998823404 */
	0x7ffbbfe5, /*  21 ->  0.9998703003 */
	0x7ffb55cd, /*  22 ->  0.9998576641 */
	0x7ffae6c6, /*  23 ->  0.9998444319 */
	0x7ffa72d0, /*  24 ->  0.9998306036 */
	0x7ff9f9eb, /*  25 ->  0.9998161793 */
	0x7ff97c17, /*  26 ->  0.9998011589 */
	0x7ff8f953, /*  27 ->  0.9997856021 */
	0x7ff871a1, /*  28 ->  0.9997693896 */
	0x7ff7e4ff, /*  29 ->  0.9997526407 */
	0x7ff7536f, /*  30 ->  0.9997352958 */
	0x7ff6bcef, /*  31 ->  0.9997173548 */
	0x7ff62181, /*  32 ->  0.9996988177 */
	0x7ff58124, /*  33 ->  0.9996796846 */
	0x7ff4dbd8, /*  34 ->  0.9996600151 */
	0x7ff4319c, /*  35 ->  0.9996396899 */
	0x7ff38273, /*  36 ->  0.9996188283 */
	0x7ff2ce5a, /*  37 ->  0.9995973706 */
	0x7ff21552, /*  38 ->  0.9995753169 */
	0x7ff1575c, /*  39 ->  0.9995526671 */
	0x7ff09477, /*  40 ->  0.9995294213 */
	0x7fefcca3, /*  41 ->  0.9995055795 */
	0x7feeffe0, /*  42 ->  0.9994812012 */
	0x7fee2e2f, /*  43 ->  0.9994561672 */
	0x7fed5790, /*  44 ->  0.9994305968 */
	0x7fec7c01, /*  45 ->  0.9994044304 */
	0x7feb9b84, /*  46 ->  0.9993776679 */
	0x7feab619, /*  47 ->  0.9993503094 */
	0x7fe9cbbf, /*  48 ->  0.9993223548 */
	0x7fe8dc77, /*  49 ->  0.9992938638 */
	0x7fe7e840, /*  50 ->  0.9992647171 */
	0x7fe6ef1b, /*  51 ->  0.9992350340 */
	0x7fe5f107, /*  52 ->  0.9992047548 */
	0x7fe4ee05, /*  53 ->  0.9991738796 */
	0x7fe3e615, /*  54 ->  0.9991424084 */
	0x7fe2d937, /*  55 ->  0.9991103411 */
	0x7fe1c76a, /*  56 ->  0.9990777373 */
	0x7fe0b0b0, /*  57 ->  0.9990444779 */
	0x7fdf9507, /*  58 ->  0.9990106821 */
	0x7fde7470, /*  59 ->  0.9989762902 */
	0x7fdd4eeb, /*  60 ->  0.9989413023 */
	0x7fdc2479, /*  61 ->  0.9989057183 */
	0x7fdaf518, /*  62 ->  0.9988695383 */
	0x7fd9c0c9, /*  63 ->  0.9988328218 */
	0x7fd8878d, /*  64 ->  0.9987954497 */
};

#define DFX ((int32_t)(1 << (31 - 2*LOG2_N)))


#if (FIXPT_SINCOS_INTRPL_POLY) || (FIXPT_SINCOS_INTRPL_POLY2)
/* Polynomial interpolation version */
int32_t f32sin(int32_t x)
{
#if (FIXPT_SINCOS_INTRPL_POLY2)
	int32_t y321;
	int32_t y32;
	int32_t y3;
	int32_t x3;
	int32_t qx2;
#endif
	int32_t y21;
	int32_t y2;
	int32_t y1;
	int32_t y;
	int32_t x2;
	int32_t x1;
	int32_t qx1;
	int64_t acc;
	int32_t i;

	i = x >> (31 - LOG2_N);

	x1 = i << (31 - LOG2_N);
	y1 = qsintab[i++ & MASK_N] * ((x1 < 0) ? -1 : 1);

	x2 = x1 + DX;
	y2 = qsintab[i++ & MASK_N] * ((x2 < 0) ? -1 : 1);

	y21 = (y2 - y1);
	qx1 = Q31_DIV(x - x1, DX);

#if (FIXPT_SINCOS_INTRPL_POLY2)
	x3 = x2 + DX;
	y3 = qsintab[i & MASK_N] * ((x3 < 0) ? -1 : 1);

	y32 = (y3 - y2);
	y321 = (y32 - y21) / 2;

	qx2 = Q31_DIV(x - x2, DX);
#endif

	acc = y1 + Q31_MUL(y21, qx1);
#if (FIXPT_SINCOS_INTRPL_POLY2)
	acc += Q31_MUL(y321, Q31_MUL(qx1, qx2));
#endif
	y = Q31_SAT(acc);

	return y;
}
#endif /* (FIXPT_SINCOS_INTRPL_POLY) || (FIXPT_SINCOS_INTRPL_POLY2) */

#if (FIXPT_SINCOS_INTRPL_TRIG)
/* Circular interpolation version, using the trigonometric 
   identity: sin(a + b) = sin(a)*cos(b) + cos(a)*sin(b) 
*/
int32_t f32sin(int32_t x)
{
	int32_t x0;
	int32_t x1;
	int32_t sin_x0;
	int32_t cos_x0;
	int32_t fx;
	int32_t ffx;
	int32_t qfx;
	int32_t sin_fx0;
	int32_t sin_fx1;
	int32_t sin_fx;
	int32_t cos_fx0;
	int32_t cos_fx1;
	int32_t cos_fx;
	int64_t acc;
	int32_t y;
	int32_t i;

	i = x >> (31 - LOG2_N);

	x0 = i << (31 - LOG2_N);
	sin_x0 = qsintab[i & MASK_N] * ((x0 < 0) ? -1 : 1);

	x1 = x0 + Q31(0.5);
	i = x1 >> (31 - LOG2_N);
	cos_x0 = qsintab[i & MASK_N] * ((x1 < 0) ? -1 : 1);

	fx = (x - x0);
	i = fx >> (31 - 2*LOG2_N);

	ffx = fx - (i << (31 - 2*LOG2_N));
	qfx = Q31_DIV(ffx, DFX);

	sin_fx0 = fsintab[i];
	sin_fx1 = fsintab[i + 1];
	sin_fx = sin_fx0 + Q31_MUL(sin_fx1 - sin_fx0, qfx);

	cos_fx0 = fcostab[i];
	cos_fx1 = fcostab[i + 1];
	cos_fx = cos_fx0 + Q31_MUL(cos_fx1 - cos_fx0, qfx);

	acc = Q31_MUL(sin_x0, cos_fx);
	acc += Q31_MUL(cos_x0, sin_fx);
	y = Q31_SAT(acc);

	return y;
}
#endif /* (FIXPT_SINCOS_INTRPL_TRIG) */
